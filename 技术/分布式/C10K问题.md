## C10K问题

C10K = 单机1万个并发连接；

C10M = 单机1千万个并发连接；

### 问题本质

创建进程、线程多了，数据的拷贝频繁，上下文切换大，导致操作系统崩溃；



### 解决方案：

> 每个进程或线程同时处理多个连接（IO多路复用）

1、直接循环处理多个连接，但是任务文件句柄不成功会阻塞整个应用；

2、select：在读取文件句柄之前，先查询状态，ready才处理。但是查询句柄状态，连接过多的时候也会影响效率；

3、poll：

1. 通过pollrd向内核传递需要关注的事件消除文件句柄
2. 同时使用不同字段分别标注关注事件和发生时间；

4、epoll：调用返回时，只给应用提供发生了状态变化的句柄；

性能远大于select和poll

FreeBSD推出了kqueue，Linux推出了epoll，Windows推出了IOCP；

5、libevent：跨平台，已支持以下接口/dev/poll, kqueue, event ports, select, poll 和 epoll；



